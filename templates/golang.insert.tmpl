{{- define "signature" -}}
Create{{ .Suffix }}({{ param .Args }}) ({{ param .Return }}, err error)
{{- end -}}

{{- define "body" -}}{
    {{- if .NeedsNow }}
    __now := Now().UTC()
    {{ end -}}
    {{ initnew .Fields }}
	const __stmt=`{{ .SQL }}`
	__prepared, __replace, err := obj.prepare(__stmt)
	if err != nil {
        return {{ zero .Return }}, WrapErr(err)
	}
	defer __replace()
	obj.logStmt(__stmt, {{ arg .Fields }})

    {{ if .SupportsReturning }}
    {{ init .Return }}
    err = __prepared.QueryRow({{ arg .Fields }}).Scan({{ addrof (flatten .Return) }})
    if err != nil {
        return {{ zero .Return }}, WrapErr(err)
    }
    return {{ arg .Return }}, nil
    {{ else -}}
    __res, err := __prepared.Exec({{ arg .Fields}})
    if err != nil {
        return {{ zero .Return}}, WrapErr(err)
    }
    __pk, err := __res.LastInsertId()
    if err != nil {
        return {{ zero .Return }}, WrapErr(err) 
    }
    return obj.getLast{{ .Return.Type }}(__pk)
    {{ end -}}
}
{{ end -}}
